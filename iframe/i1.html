<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <body>
      æˆ‘æ˜¯ 1.html, ä¸‹é¢åµŒå¥— 2.html
      <iframe src="http://127.0.0.1:8000/i2.html" name="child"></iframe>
      <script>
        function hello() {
          console.log("this is 1.html");
        }

        var iframe = document.getElementsByTagName("iframe")[0];
        console.log("contentWindow ğŸ¥", iframe.contentWindow); // èƒ½è®¿é—®
        console.log("contentDocument ğŸ¥", iframe.contentDocument); // èƒ½è®¿é—®

        // æ³¨æ„è®¿é—®æ–¹å¼, éœ€è¦åœ¨ onload åæ‰èƒ½å–åˆ°å€¼
        // console.log( iframe.contentWindow.hello() ) // Uncaught TypeError: iframe.contentWindow.hello is not a function

        iframe.onload = function() {
          console.log(iframe.contentWindow.hello(), "==hello"); // this is 2.html //  è¾“å‡º Location å¯¹è±¡ï¼Œ ä¾ç„¶è¦åœ¨ iframe.onload ä¸­è®¿é—®
          console.log(
            "contentWindow.location ğŸ¥",
            iframe.contentWindow.location
          ); //  iframe.contentWindow.location.host : 127.0.0.1:8000 //  xxx.hash: Â  Â  "" //  xxx.host: Â  Â  "127.0.0.1:8000" //  xxx.hostname: "127.0.0.1" //  xxx.href: Â  Â  "http://127.0.0.1:8000/2.html" //  xxx.origin: Â  "http://127.0.0.1:8000" //  xxx.pathname: "/2.html" //  xxx.port: Â  Â  "8000" //  xxx.protocol: "http:" //  ... // æœ‰ç›¸åŒçš„æº æˆ‘ä»¬å¯ä»¥è¿›è¡Œä»»ä½•æ“ä½œ
          iframe.contentDocument.body.innerHTML = "<p>hi, i am ur father !</p>";
          console.log(iframe.contentDocument.getElementsByTagName("p"), "==p");

          // onloadå‘é€æ¶ˆæ¯
          let childFrame = window.frames.child;
          console.log(window.frames, "==framesList", window.frames.child);
          childFrame.postMessage("i am father", "http://127.0.0.1:8000");
        };

        // iframe.contentWindow.location = 'http://www.360doc.com'; // å¯ä»¥ç›´æ¥ä¿®æ”¹ iframe åœ°å€, ä¸å—åŒæºç­–ç•¥çš„é™åˆ¶ã€‚ æœ‰çš„ç½‘ç«™ä¸æ”¯æŒè¢«iframeå¼•ç”¨, æ‰€ä»¥ä¼šæŠ¥é”™ã€‚ æ³¨æ„åŒºåˆ†é”™è¯¯ä¿¡æ¯ã€‚
        // onloadå‘é€æ¶ˆæ¯
        let childFrame = window.frames.child;
        console.log(window.frames, "==framesList", window.frames.child);
        childFrame.postMessage("ç¬¬ä¸€æ¬¡å‘é€", "http://127.0.0.1:8000");

        window.addEventListener("message", function(event) {
          console.log(event, "==event");
          if (event.origin !== "http://127.0.0.1:8000") {
            // æ¥è‡ªæœªçŸ¥çš„æºçš„å†…å®¹ï¼Œæˆ‘ä»¬å¿½ç•¥å®ƒ
            return;
          }
          if (window === event.source) {
            return;
          }
          console.log('çˆ¶äº²æ”¶åˆ°äº†')
          console.log("received:", event.data);
        });
      </script>
    </body>
  </body>
</html>
